<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Visualize clusters in CyTOF data using a minimum spanning tree (MST). — tof_plot_clusters_mst • tidytof</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualize clusters in CyTOF data using a minimum spanning tree (MST). — tof_plot_clusters_mst"><meta name="description" content="This function plots a minimum-spanning tree using clustered single-cell data
in order to summarize cluster-level characteristics. Each node in the MST
represents a single cluster colored using a user-specified variable (either
continuous or discrete)."><meta property="og:description" content="This function plots a minimum-spanning tree using clustered single-cell data
in order to summarize cluster-level characteristics. Each node in the MST
represents a single cluster colored using a user-specified variable (either
continuous or discrete)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidytof</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidytof.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending {tidytof}</h6></li>
    <li><a class="dropdown-item" href="../articles/contributing-to-tidytof.html">How to contribute code</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cell-level operations</h6></li>
    <li><a class="dropdown-item" href="../articles/reading-and-writing-data.html">Reading and writing data</a></li>
    <li><a class="dropdown-item" href="../articles/quality-control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="../articles/preprocessing.html">Preprocessing</a></li>
    <li><a class="dropdown-item" href="../articles/downsampling.html">Downsampling</a></li>
    <li><a class="dropdown-item" href="../articles/dimensionality-reduction.html">Dimensionality reduction</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Cluster-level operations</h6></li>
    <li><a class="dropdown-item" href="../articles/clustering.html">Clustering and metaclustering</a></li>
    <li><a class="dropdown-item" href="../articles/differential-discovery-analysis.html">Differential discovery analysis</a></li>
    <li><a class="dropdown-item" href="../articles/feature-extraction.html">Feature extraction</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Sample-level operations</h6></li>
    <li><a class="dropdown-item" href="../articles/modeling.html">Building predictive models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keyes-timothy/tidytof/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualize clusters in CyTOF data using a minimum spanning tree (MST).</h1>
      <small class="dont-index">Source: <a href="https://github.com/keyes-timothy/tidytof/blob/main/R/visualization.R" class="external-link"><code>R/visualization.R</code></a></small>
      <div class="d-none name"><code>tof_plot_clusters_mst.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots a minimum-spanning tree using clustered single-cell data
in order to summarize cluster-level characteristics. Each node in the MST
represents a single cluster colored using a user-specified variable (either
continuous or discrete).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tof_plot_clusters_mst</span><span class="op">(</span></span>
<span>  <span class="va">tof_tibble</span>,</span>
<span>  <span class="va">cluster_col</span>,</span>
<span>  knn_cols <span class="op">=</span> <span class="fu"><a href="where.html">where</a></span><span class="op">(</span><span class="va">tof_is_numeric</span><span class="op">)</span>,</span>
<span>  <span class="va">color_col</span>,</span>
<span>  num_neighbors <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  graph_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unweighted"</span>, <span class="st">"weighted"</span><span class="op">)</span>,</span>
<span>  graph_layout <span class="op">=</span> <span class="st">"nicely"</span>,</span>
<span>  central_tendency_function <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span>,</span>
<span>  distance_function <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"euclidean"</span>, <span class="st">"cosine"</span><span class="op">)</span>,</span>
<span>  edge_alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  node_size <span class="op">=</span> <span class="st">"cluster_size"</span>,</span>
<span>  theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tof-tibble">tof_tibble<a class="anchor" aria-label="anchor" href="#arg-tof-tibble"></a></dt>
<dd><p>A `tof_tbl` or a `tibble`.</p></dd>


<dt id="arg-cluster-col">cluster_col<a class="anchor" aria-label="anchor" href="#arg-cluster-col"></a></dt>
<dd><p>An unquoted column name indicating which column in `tof_tibble`
stores the cluster ids for the cluster to which each cell belongs.
Cluster labels can be produced via any method the user chooses - including manual gating,
any of the functions in the `tof_cluster_*` function family, or any other method.</p></dd>


<dt id="arg-knn-cols">knn_cols<a class="anchor" aria-label="anchor" href="#arg-knn-cols"></a></dt>
<dd><p>Unquoted column names indicating which columns in `tof_tibble`
should be used to compute the cluster-to-cluster distances used to construct
the k-nearest-neighbor graph. Supports tidyselect helpers. Defaults to all
numeric columns.</p></dd>


<dt id="arg-color-col">color_col<a class="anchor" aria-label="anchor" href="#arg-color-col"></a></dt>
<dd><p>Unquoted column name indicating which column in `tof_tibble`
should be used to color the nodes in the MST.</p></dd>


<dt id="arg-num-neighbors">num_neighbors<a class="anchor" aria-label="anchor" href="#arg-num-neighbors"></a></dt>
<dd><p>An integer specifying how many neighbors should be used
to construct the k-nearest neighbor graph.</p></dd>


<dt id="arg-graph-type">graph_type<a class="anchor" aria-label="anchor" href="#arg-graph-type"></a></dt>
<dd><p>A string specifying if the k-nearest neighbor graph should
be "weighted" (the default) or "unweighted".</p></dd>


<dt id="arg-graph-layout">graph_layout<a class="anchor" aria-label="anchor" href="#arg-graph-layout"></a></dt>
<dd><p>This argument specifies a layout for the MST in one of two ways.
Option 1: Provide a string specifying which algorithm should be used to
compute the force-directed layout. Passed to <code><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></code>.
Defaults to "nicely", which tries to automatically select a visually-appealing
layout. Other examples include "fr", "gem", "kk", and many others. See
<code><a href="https://ggraph.data-imaginist.com/reference/layout_tbl_graph_igraph.html" class="external-link">layout_tbl_graph_igraph</a></code> for other examples.
Option 2: Provide a ggraph object previously generated with this
function. The layout used to plot this ggraph object will then be used as a
template for the new plot. Using this option, number of clusters (and their
labels) must be identical to the template. This option is useful if you want
to make multiple plots of the same tof_tibble colored by different protein
markers, for example.</p></dd>


<dt id="arg-central-tendency-function">central_tendency_function<a class="anchor" aria-label="anchor" href="#arg-central-tendency-function"></a></dt>
<dd><p>A function to use for computing the
measure of central tendency that will be aggregated from each cluster in
cluster_col. Defaults to the median.</p></dd>


<dt id="arg-distance-function">distance_function<a class="anchor" aria-label="anchor" href="#arg-distance-function"></a></dt>
<dd><p>A string indicating which distance function to use
in computing the cluster-to-clusters distances in constructing the MST.
Valid options include "euclidean" (the default) and "cosine".</p></dd>


<dt id="arg-edge-alpha">edge_alpha<a class="anchor" aria-label="anchor" href="#arg-edge-alpha"></a></dt>
<dd><p>A numeric value between 0 and 1 specifying the transparency
of the edges drawn in the force-directed layout. Defaults to 0.25.</p></dd>


<dt id="arg-node-size">node_size<a class="anchor" aria-label="anchor" href="#arg-node-size"></a></dt>
<dd><p>Either a numeric value specifying the size of the nodes in the
MST or the string "cluster_size", in which case the size of the node representing
each cluster will be scaled according to the number of cells in that cluster
(the default).</p></dd>


<dt id="arg-theme">theme<a class="anchor" aria-label="anchor" href="#arg-theme"></a></dt>
<dd><p>A ggplot2 theme to apply to the force-directed layout.
Defaults to <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional additional arguments to <code><a href="https://rdrr.io/pkg/RcppHNSW/man/hnsw_knn.html" class="external-link">hnsw_knn</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggraph/ggplot object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sim_data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        cd45 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cd38 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cd34 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cd19 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        cluster_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, size <span class="op">=</span> <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make a layout colored by a marker</span></span></span>
<span class="r-in"><span><span class="va">layout_cd38</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">tof_plot_clusters_mst</span><span class="op">(</span></span></span>
<span class="r-in"><span>        tof_tibble <span class="op">=</span> <span class="va">sim_data</span>,</span></span>
<span class="r-in"><span>        cluster_col <span class="op">=</span> <span class="va">cluster_id</span>,</span></span>
<span class="r-in"><span>        color_col <span class="op">=</span> <span class="va">cd38</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use the same layout as the plot above to color the same</span></span></span>
<span class="r-in"><span><span class="co"># tree using a different marker</span></span></span>
<span class="r-in"><span><span class="va">layout_cd45</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu">tof_plot_clusters_mst</span><span class="op">(</span></span></span>
<span class="r-in"><span>        tof_tibble <span class="op">=</span> <span class="va">sim_data</span>,</span></span>
<span class="r-in"><span>        cluster_col <span class="op">=</span> <span class="va">cluster_id</span>,</span></span>
<span class="r-in"><span>        color_col <span class="op">=</span> <span class="va">cd45</span>,</span></span>
<span class="r-in"><span>        graph_layout <span class="op">=</span> <span class="va">layout_cd38</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Timothy Keyes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

